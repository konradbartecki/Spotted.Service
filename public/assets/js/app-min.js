"use strict";var ApplicationConfiguration=function(){var e="spotted",o=["ui.router","angular-jwt"],t=function(o,t){angular.module(o,t||[]),angular.module(e).requires.push(o)};return{applicationModuleName:e,applicationModuleVendorDependencies:o,registerModule:t}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function(e){e.html5Mode(!0).hashPrefix("!")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])}),angular.module(ApplicationConfiguration.applicationModuleName).config(function(e,o){o.tokenGetter=function(){return localStorage.getItem("token")},e.interceptors.push("jwtInterceptor")}).run(function(e,o,t){o.$on("$stateChangeStart",function(o,r){r.data&&r.data.requireQuest?t.localStorage.getItem("token")&&(o.preventDefault(),e.go("home")):r.data&&r.data.requireLogin&&(t.localStorage.getItem("token")||(o.preventDefault(),e.go("login")))})}).factory("userService",function(e){var o=localStorage.getItem("token");if(o){var t=o&&e.decodeToken(o);return{user:t.user}}return{user:""}}),ApplicationConfiguration.registerModule("core"),ApplicationConfiguration.registerModule("users"),angular.module("users").factory("usersFactory",function(){return{api:{login:"api/v1/users/login",register:"api/v1/users/register"}}}),angular.module("core").config(["$stateProvider","$urlRouterProvider",function(e,o){o.otherwise("404"),e.state("home",{url:"/",templateUrl:"app/modules/core/client/views/home/home.client.view.html"}).state("404",{url:"/404",templateUrl:"app/modules/core/client/views/error/404.client.view.html"})}]),angular.module("users").config(["$stateProvider",function(e){e.state("user",{url:"/user",data:{requireLogin:!0}}).state("login",{url:"/user/login",templateUrl:"app/modules/users/client/views/login/login.client.view.html",data:{requireQuest:!0}}).state("register",{url:"/user/register",templateUrl:"app/modules/users/client/views/register/register.client.view.html",data:{requireQuest:!0}})}]),angular.module("core").controller("headerController",["$scope","userService",function(e,o){e.user=o.user}]),angular.module("users").controller("loginController",["$scope","$http","usersFactory","$window","$state",function(e,o,t,r,n){e.login=function(){o({url:t.api.login,method:"POST",data:e.user}).then(function(e){var o=e.data.status;200===o?(r.localStorage.setItem("token",e.data.token),n.go("home")):401===o&&console.log("Podany adres e-mail lub hasło są nieprawidłowe!")})}}]).controller("registerController",["$scope","$http","usersFactory","$state",function(e,o,t,r){e.user={email:"",password:"",sex:""},e.register=function(){o({url:t.api.register,method:"POST",data:e.user}).then(function(o){console.log(e.user);var t=o.data.status;200===t?r.go("login"):409===t&&console.log("Do podanego adresu e-mail przypisane jest już konto użytkownika!!")})}}]);